---
title: "Détermination des critères de sexage de *Varanus salvator*"
author: "Baire Alexia, Spagna Camille, Curto Jeanne, Hallot Lou"
format:
  pdf:
    documentclass: report
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Un rapport est différent d'un carnet de notes. Il ne s'agit donc pas de faire du copier-coller d'un document vers l'autre. Un rapport de synthèse doit être compréhensible sans devoir lire le carnet de notes. Le rapport de synthèse doit être  rédigé avec un style et une présentation adéquats. -->

## Introduction

<!--% Rédigez l'introduction de ce rapport en 5-6 phrases.-->

La détermination du sexe chez les reptiles peut s’avérer complexe, notamment chez les espèces présentant peu de dimorphisme sexuel externe [@alymann2024a]. *Varanus salvator*, le varan d’eau asiatique, est une espèce où les différences morphologiques entre mâles et femelles existent mais restent parfois difficiles à observer sans capture ou examen invasif.

Dans ce projet, nous analysons une population de *Varanus salvator* à partir de mesures morphométriques diverses, telles que la longueur du corps, la circonférence de la queue ou les dimensions du crâne. Cependant, il convient de noter que ces mesures proviennent d’individus élevés pour le commerce de la peau, où les animaux sélectionnés pèsent généralement moins de 5 kg. Cette contrainte pourrait limiter la représentativité des résultats pour les conditions naturelles et la détermination du sexe dans la population sauvage.

## But

<!--% Rédigez le but de ce rapport en 2 phrases.-->

Le but de ce projet est donc de déterminer si des relations morphométriques spécifiques permettent de distinguer les mâles des femelles de *Varanus salvator.*

## Matériel et méthodes

<!--% Cette section doit comprendre deux parties. La première partie doit expliciter les données employées et la seconde traiter des analyses réalisées et des logiciels employés.-->

Le jeu de donnée a été trouvé sur le site [Nature](https://www.nature.com/) dans la section Scientific data. Il comporte 146 individus et 20 variables. Plus amples informations sur ce jeu de données ont été trouvées au sein de [@alymann2024].

L'analyse est réalisée avec le logiciel R (`r R.version.string`) et en particulier le package {modelit} version `r packageVersion("modelit")` avec la [SciViews Box 2025](https://www.sciviews.org/software/svbox/) dans [Saturn Cloud](https://saturncloud.io/) (Linux Ubuntu 22.04). Le seuil $\alpha$ de tous les tests est fixé à l'avance à 5%.

## Résultats

<!--% Présentez les deux modèles les plus pertinents que vous avez sélectionnés. Structurez la section en deux parties avec deux titres de niveau trois.-->

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model")
```

```{r import}
# Lecture des données
lezards <- read("data/lezards.rds")

# Tableau des premières et dernières lignes
tabularise$headtail(lezards)
```

### Longueur de la queue et circonférence de la base de la queue en fonction du sexe

```{r graphique1}
a <- chart(data=lezards, circbasequeue ~ masse %col=% sexe_rec) +
  geom_point()+
  stat_smooth(method="lm", formula = y ~ x)+
  scale_color_brewer(palette = "Accent")+
  labs(x="Masse [Kg]", col = "Sexe")

b <- chart(data=lezards, circbasequeue ~ longqueue %col=% sexe_rec) +
  geom_point()+
  stat_smooth(method="lm", formula = y ~ x)+
  scale_color_brewer(palette = "Accent")+
  labs(col = "Sexe")

combine_charts(list(a, b), common.legend = TRUE)
```

```{r modèlelinéairegénéralisé1}
lezards_mlg1 <- glm(data = lezards, sexe_rec ~ cbq_lt + lq_lt, family=binomial)
tabularise(summary_(lezards_mlg1_2))
```

Tous les paramètres sont significativement différents de 0 au seuil $\alpha$ de 5%. La déviance des résidus est de 1,25 ce qui est plutôt proche de 1. Ceci signifierait qu'il n'y a pas de surdispersion.

$$
`r eq__(lezards_mlg1, use_coefs = TRUE, coefs_digits = 3)`
$$

### Interaction de la largeur et de la longueur du crâne en fonction du sexe

```{r modèlelinéairegénéralisé2}
lezards_mlg2 <- glm(data = lezards, sexe_rec ~ largcrane * longcrane, family = binomial)
tabularise(summary_(lezards_mlg2_1))
```

Tous les paramètres sont significativement différents de 0 au seuil $\alpha$ de 5%. La déviance des résidus est de 1,3, cette valeur est assez proche de 1, il n'y a de surdispersion et il ne faut donc pas réajuster le paramètre de dispersion.

$$
`r eq__(lezards_mlg2, use_coefs = TRUE, coefs_digits = 3)`
$$

## Discussion et Conclusion

<!--% En tenant compte du but de votre carnet de notes et de vos résultats, discutez de résultats et proposez des conclusions à votre analyse en 5 à 10 phrases. -->

## Bibliographie
