---
title: "___"
author: "Alexia Baire, Camille Spagna, Jeanne Curto, Lou Hallot"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but (que vous remanierez éventuellement en fonction des modèles que vous ajouterez plus tard). Vous pouvez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

Au cours de ce projet, l'analyse des Varanus Salvator va être réalisée. Le jeu de donnée a été trouvé sur le site [Nature](https://www.nature.com/) dans la section Scientific data. Plus amples informations sur ce jeu de données ont été trouvée au sein de [@alymann2024]

Le but de ce projet est de voir si il est possible de déterminer le sexe de ces individus en fonction de mesures morphométriques diverses.

## Matériel et méthodes

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets du premier module de SDD II. -->

Lien du truc ou on a trouvé les données :

<https://figshare.com/ndownloader/files/44709583>

<https://figshare.com/articles/dataset/Varanus_salavator_morphology_sex_prediction_19_Features_csv/24558595?utm_source=chatgpt.com&file=44709583>

## Analyses

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model")
```

<!--% Importez les données que vous aurez préalablement nettoyées, remaniées et labélisées dans le script R nommé `R/import.R`. -->

```{r import}
# Lecture des données
lezards <- read("data/lezards.rds")

# Tableau des premières et dernières lignes
tabularise$headtail(lezards)
```

### Description des données

<!--% Chaque étudiant réalise et interprète un graphique pertinent en lien avec le but fixé et les modèles qui seront réalisés. Graphique et interprétation de l'étudiant #1 ci-dessous. -->

```{r}
lezards$sexe <- as.factor(lezards$sexe)

## Recodage de lezards$sexe en lezards$sexe_rec
lezards$sexe_rec <- lezards$sexe |>
  fct_recode(
    "M" = "0",
    "F" = "1"
  )

## Recodage de lezards$masse en lezards$masse_rec
lezards$masse_rec <- cut(lezards$masse,
  include.lowest = TRUE,
  right = FALSE,
  dig.lab = 4,
  breaks = c(0, 3, 5, 8)
)

## Recodage de lezards$masse_rec en lezards$masse_rec_rec
lezards$masse_rec_rec <- lezards$masse_rec |>
  fct_recode(
    "Léger" = "[0,3)",
    "Moyen" = "[3,5)",
    "Lourd" = "[5,8]"
  )
```

```{r chart1Alexia}
chart(data = lezards, circbasequeue ~ masse %col=% sexe_rec) +
  geom_point()+ 
  labs(col="Sexe")+
  stat_smooth(method = "lm", formula = y ~ x)+ 
  scale_color_brewer(palette = "Accent")

```

... interprétation #1...

<!--% Graphique et interprétation de l'étudiant #2 ci-dessous. -->

```{r chart2Camille}
A <- chart(data = lezards, longtot ~ masse_rec_rec %fill=% sexe_rec) +
  geom_boxplot() +
  labs(fill = "Sexe", x = "Masse") +
  scale_fill_brewer(palette = "Accent")

B <- chart(data = lezards, longsansqueue ~ masse_rec_rec %fill=% sexe_rec) +
  geom_boxplot() +
  labs(fill = "Sexe", x = "Masse") +
  scale_fill_brewer(palette = "Accent")

combine_charts(list(A, B), common.legend = TRUE)
```

... interprétation #2...

<!--% Graphique et interprétation de l'étudiant #3 ci-dessous. -->

```{r chart3Jeanne}
chart(data=lezards, longtot ~ bodycond %col=% sexe_rec) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x) +
  labs(col = "Sexe") +
  scale_color_brewer(palette = "Accent")
```

Le graphique montre que, pour une même condition corporelle, les mâles de *Varanus salvator* tendent à présenter une longueur totale plus élevée que les femelles. Cette différence traduit le dimorphisme sexuel de l’espèce, les mâles étant généralement plus longs. Malgré une variabilité importante, cette tendance suggère que la combinaison longueur–condition corporelle peut constituer un indice utile pour le sexage lorsque les critères externes sont difficiles à distinguer.

<!--% Graphique et interprétation de l'étudiant #4 ci-dessous. -->

```{r chart4Lou}
a <- chart(data = lezards, ~ largcrane %fill=% sexe_rec | sexe_rec) +
  geom_histogram(show.legend = FALSE, bins = 15) +
  ylab("Effectifs") +
  scale_fill_brewer(palette = "Accent")

b <- chart(data = lezards, ~ longcrane %fill=% sexe_rec | sexe_rec) +
    geom_histogram(show.legend = FALSE, bins = 15) +
  ylab("Effectifs") +
  scale_fill_brewer(palette = "Accent")

combine_charts(list(a, b))

```

A FAIRE

-Globalement, largeur et longueur du crâne des Vanarus salvator diffèrent entre les individus mâles et femelles

-femelles ont des valeurs plus basses d'au moins 1 centimètre par rapport aux mâles dans les 2 variables

-Ainsi femelles ont crâne légèrement plus petit que les mâles

### Modélisation

<!--% Chaque modèle doit être décrit à l'aide d'un graphique et d'un tableau résumant le modèle. Les équations paramétrées de tous les modèles doivent être également présentes. L'analyse des résidus sera réalisée et interprétée pour chaque modèle. -->

#### Régression linéaire 1

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

Notre graphique était déjà assez pertinent :

```{r regressionlineaire1graphique}
chart(data = lezards, circbasequeue ~ masse %col=% sexe_rec) +
  geom_point()+ 
  labs(col="Sexe")+
  stat_smooth(method = "lm", formula = y ~ x)+ 
  scale_color_brewer(palette = "Accent")
```

```{r regressionlineaire1AlexiaetCamille}
lezards_lm1 <- lm(data= lezards, circbasequeue ~ masse + sexe_rec)
tabularise(summary_(lezards_lm1))
```

```{r residuals1}
chart$residuals(lezards_lm1)
```

Interprétation ...

$$
`r eq__(lezards_lm1, use_coefs = TRUE)`
$$

#### Régression linéaire 2

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r graphiqueregressionlineaire2}
chart(data=lezards, longcrane ~ largcrane) +
  geom_point()+
  stat_smooth(method="lm", formula = y ~ x)
```

```{r regressionlineaire2JeanneetLou}
lezards_lm2 <- lm(data = lezards, longcrane ~ largcrane)
tabularise(summary_(lezards_lm2))
```

```{r {r residuals2}
chart$residuals(lezards_lm2)
```

$$
`r eq__(lezards_lm2, use_coefs = TRUE)`
$$

#### Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r modelelineairegraphique1}
chart(data=lezards, circbasequeue ~ masse %col=% sexe_rec) +
  geom_point()+
  stat_smooth(method="lm", formula = y ~ x)+
  scale_color_brewer(palette = "Accent")+
  labs(x="Masse [Kg]", col = "Sexe")
```

```{r modelelineaire1AlexiaetCamille}
lezards_ml1 <- lm(data= lezards, circbasequeue ~ (masse + longqueue) * sexe_rec)
tabularise(summary_(lezards_ml1))
```

```{r residuals2}
chart$residuals(lezards_ml1)
```

Interprétation...

$$
`r eq__(lezards_ml1, use_coefs = TRUE, coef_digits = 3)`
$$

#### Modèle linéaire 2

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r modelelineairegraphique2}
chart(data=lezards, longcrane ~ largcrane %col=% sexe_rec) +
  geom_point()+
  labs(col="Sexe")+
  stat_smooth(method = "lm", formula = y ~ x)+ 
  scale_color_brewer(palette = "Accent")
```

```{r modelelineaire2JeanneetLou}
lezards_ml2 <- lm(data = lezards, longcrane ~ largcrane * sexe)
tabularise(summary_(lezards_ml2))
```

```{r residuals3}
chart$residuals(lezards_ml2)
```

#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r modelelineairegeneraliseet/oumixte1AlexiaetCamille}
lezards_mlg1 <-glm(data = lezards, sexe_rec ~ cbq_lt+ + lq_lt+ masse, family=binomial)
tabularise(summary_(lezards_mlg1))
```

#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r modelelineairegeneraliseetoumixte1JeanneetLou}
lezards_mlg2 <- glm(data = lezards, sexe ~ largcrane * longcrane, family = binomial)
tabularise(summary_(lezards_mlg2))
```

## Conclusion

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les modèles les plus pertinents que vous retenez ? -->

...vos conclusions ici...

## Références

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
